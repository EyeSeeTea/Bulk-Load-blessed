"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();!function t(e,n,r){function o(i,s){if(!n[i]){if(!e[i]){var u="function"==typeof require&&require;if(!s&&u)return u(i,!0);if(a)return a(i,!0);throw new Error("Cannot find module '"+i+"'")}var c=n[i]={exports:{}};e[i][0].call(c.exports,function(t){var n=e[i][1][t];return o(n?n:t)},c,c.exports,t,e,n,r)}return n[i].exports}for(var a="function"==typeof require&&require,i=0;i<r.length;i++)o(r[i]);return o}({1:[function(t,e,n){function r(t,e){return t.replace(/{([^{}]*)}/g,function(t,n){var r=e[n];return"string"==typeof r||"number"==typeof r?r:t})}var o="https://dev.eyeseetea.com/clickup",a=function(){function t(e){_classCallCheck(this,t),this.options=e,this.token=e.token,this.apiUrl=e.apiUrl||o}return _createClass(t,[{key:"_setAuthHeader",value:function(t){t.setRequestHeader("Authorization",this.token)}},{key:"send",value:function(t){var e=this,n=(new Date).getTime()+parseInt(1e6*Math.random()).toString(),r="screenshot-"+n+".png",o=this._getPayload(t);return this._postIssue(o).then(function(n){return e._attachFileToTask(n.id,r,t.post.img)})}},{key:"_attachFileToTask",value:function(t,e,n){var r=this;return fetch(n).then(function(t){return t.blob()}).then(function(n){var o=new FormData;return o.append("filename",e),o.append("attachment",n),$.ajax({url:r.apiUrl+"/task/"+t+"/attachment",beforeSend:r._setAuthHeader.bind(r),data:o,processData:!1,contentType:!1,type:"POST"})})}},{key:"_getPayload",value:function(t){var e=t.post,n=e.browser,o=e.contact?"Contact info: "+e.contact.name+" ("+e.contact.email+")":"",a=["## Browser","- Name: "+n.appCodeName,"- Version: "+n.appVersion,"- Platform: "+n.platform,"","## User report",o,"URL: "+e.url,"",e.note].join("\n"),i={body:a,username:this.options.username},s=this.options.body?r(this.options.body,i):a;return{name:r(this.options.title,{title:e.title}),markdown_description:s,assignees:[],tags:["feedback-tool"],status:this.options.status||"Backlog"}}},{key:"_postIssue",value:function(t){return $.ajax({type:"POST",url:this.apiUrl+"/list/"+this.options.listId+"/task",beforeSend:this._setAuthHeader.bind(this),dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify(t)}).then(function(t){return t})}}]),t}();window.feedbackClickUp=function(t){return t.listId?new a(t):{send:function(){return Promise.resolve(null)}}}},{}]},{},[1]);