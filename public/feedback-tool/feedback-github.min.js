"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();!function e(t,n,r){function o(i,a){if(!n[i]){if(!t[i]){var u="function"==typeof require&&require;if(!a&&u)return u(i,!0);if(s)return s(i,!0);throw new Error("Cannot find module '"+i+"'")}var c=n[i]={exports:{}};t[i][0].call(c.exports,function(e){var n=t[i][1][e];return o(n?n:e)},c,c.exports,e,t,n,r)}return n[i].exports}for(var s="function"==typeof require&&require,i=0;i<r.length;i++)o(r[i]);return o}({1:[function(e,t,n){function r(e,t){return e.replace(/{([^{}]*)}/g,function(e,n){var r=t[n];return"string"==typeof r||"number"==typeof r?r:e})}var o="https://dev.eyeseetea.com/github",s=function(){function e(t){_classCallCheck(this,e),this.options=t,this.token=t.token?t.token.join(""):void 0,this.apiUrl=t.apiUrl||o}return _createClass(e,[{key:"_setAuthHeader",value:function(e){e.setRequestHeader("Authorization","token "+this.token)}},{key:"send",value:function(e){var t=this,n=e.post.img.split(",")[1],r=(new Date).getTime()+parseInt(1e6*Math.random()).toString();return this._uploadFile("screenshot-"+r+".png",n).then(function(n){return t._getPayload(e,n)}).then(function(e){return t.options.createIssue?t._postIssue(e):e})}},{key:"_uploadFile",value:function(e,t){var n={message:"feedback.js snapshot",branch:this.options.snapshots.branch,content:t};return $.ajax({url:this.apiUrl+"/repos/"+this.options.snapshots.repository+"/contents/"+e,type:"PUT",beforeSend:this._setAuthHeader.bind(this),dataType:"json",data:JSON.stringify(n)}).then(function(e){return e.content.download_url})}},{key:"_getPayload",value:function(e,t){var n=e.post,o=n.browser,s=n.contact?"Contact info: "+n.contact.name+" ("+n.contact.email+")":"",i=["## Browser","- Name: "+o.appCodeName,"- Version: "+o.appVersion,"- Platform: "+o.platform,"","## User report",s,"URL: "+n.url,"",n.note,"","![See screenshot here]( "+t+" )"].join("\n"),a={body:i,username:this.options.username};return{title:r(this.options.issues.title,{title:n.title}),body:this.options.issues.body?r(this.options.issues.body,a):i}}},{key:"_postIssue",value:function(e){return $.ajax({type:"POST",url:this.apiUrl+"/repos/"+this.options.issues.repository+"/issues",beforeSend:this._setAuthHeader.bind(this),dataType:"json",data:JSON.stringify(e)}).then(function(t){return Object.assign(e,{issueURL:t.html_url})})}}]),e}();window.feedbackGithub=function(e){var t=e.createIssue||e.sendToDhis2UserGroups.length>0;return t?new s(e):{send:function(){return Promise.resolve(null)}}}},{}]},{},[1]);